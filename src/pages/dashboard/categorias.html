<!-- ======================================================
     üéØ VISTA PRINCIPAL CON TRES MODOS
====================================================== -->
<div id="modoCategorias">

  <!-- üß± MODO CRUD (Lista principal) -->
  <div id="vistaRaiz" class="vista-raiz">
    <!-- üìã FORMULARIO DE NUEVA CATEGOR√çA -->
    <form id="formCategoria" class="categoria-form">
      <label for="nombre" class="label">Nombre</label>
      <input type="text" id="nombre" class="input" placeholder="Nombre de la categor√≠a" required />

      <label for="descripcion" class="label">Descripci√≥n</label>
      <input type="text" id="descripcion" class="input" placeholder="Descripci√≥n (opcional)" />

      <button type="submit" class="btn btn--primary">Agregar Categor√≠a</button>
    </form>

    <!-- ‚úÖ LISTADO DE TARJETAS -->
    <div class="categorias-container">
      <h2>Categor√≠as</h2>
      <ul id="listaCategorias" class="grid-categorias">
        <!-- Se llenan din√°micamente -->
      </ul>
    </div>
  </div>

  <!-- üîç MODO DETALLE (Vista individual de una categor√≠a) -->
  <div id="vistaDetalle" class="vista-detalle" style="display: none;">
    <header class="detalle-header">
      <button class="btn-volver" onclick="volverALista()">‚¨Ö Volver a la lista</button>
      <h2 id="detalleTitulo">Detalle de Categor√≠a</h2>
    </header>

    <div class="detalle-content">
      <div class="detalle-info">
        <h3 id="detalleNombre"></h3>
        <p id="detalleDescripcion"></p>
        <div class="detalle-stats">
          <span class="stat">Subcategor√≠as: <strong id="detalleSubcount">0</strong></span>
          <span class="stat">Productos: <strong id="detalleProductos">0</strong></span>
        </div>
      </div>

      <!-- üéØ SECCI√ìN DE SUBCATEGOR√çAS -->
      <div class="seccion-subcategorias">
        <div class="seccion-header">
          <h4>Subcategor√≠as</h4>
          <button class="btn-small" onclick="crearSubcategoriaEnDetalle()">‚ûï Nueva Subcategor√≠a</button>
        </div>
        <div id="listaSubcategorias" class="grid-categorias">
          <!-- Subcategor√≠as se cargar√°n aqu√≠ -->
        </div>
      </div>

      <!-- üéØ SECCI√ìN DE PRODUCTOS -->
      <div class="seccion-productos">
        <div class="seccion-header">
          <h4>Productos en esta categor√≠a</h4>
          <!-- üîπ NUEVO BOT√ìN: abrir modal de productos -->
          <button class="btn-small btn--primary"
            onclick="mostrarModalProducto(window.categoriaActualId, document.getElementById('detalleNombre').textContent)">
            ‚ûï Agregar Producto
          </button>
        </div>

        <div id="listaProductos" class="grid-productos">
          <!-- Productos se cargar√°n aqu√≠ -->
        </div>
      </div>
    </div>
  </div>

  <!-- üß≠ MODO NAVEGACI√ìN (Niveles > 0) -->
  <div id="vistaNavegacion" class="vista-navegacion" style="display: none;">
    <header class="categorias__header">
      <!-- Breadcrumbs -->
      <nav id="breadcrumbs" class="breadcrumbs"></nav>
      <!-- Bot√≥n Volver -->
      <button id="btnVolver" class="btn-volver" disabled>‚¨Ö Volver</button>
    </header>

    <!-- üì¶ Vista din√°mica de subcategor√≠as o productos -->
    <main id="vistaCategorias" class="categorias__main">
      <!-- Render din√°mico controlado por navegacion-categorias.js -->
    </main>
  </div>
</div>

<!-- ======================================================
     üß© MODAL: AGREGAR PRODUCTO A CATEGOR√çA (MEJORADO)
====================================================== -->
<div id="modalProducto" class="modal" style="display: none;" role="dialog" aria-labelledby="modalTitulo" aria-modal="true">
  <div class="modal-content">
    <span class="close-modal" onclick="cerrarModalProducto()" aria-label="Cerrar modal">&times;</span>

    <h2 id="modalTitulo">üÜï Agregar Producto a <span id="modalCategoriaNombre"></span></h2>

    <form id="formProducto" class="producto-form" novalidate>
      <input type="hidden" id="modalCategoriaId">

      <div class="form-row">
        <div class="form-group">
          <label for="productoNombre">Nombre del Producto *</label>
          <input type="text" id="productoNombre" required placeholder="Ej: Gaseosa Coca-Cola 500ml">
        </div>

        <div class="form-group">
          <label for="productoDescripcion">Descripci√≥n</label>
          <textarea id="productoDescripcion" placeholder="Descripci√≥n opcional" rows="3"></textarea>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="productoPrecio">Precio Unitario *</label>
          <input type="number" id="productoPrecio" step="0.01" min="0" required placeholder="0.00">
        </div>

        <div class="form-group">
          <label for="productoStock">Cantidad / Stock *</label>
          <input type="number" id="productoStock" min="1" value="1" required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="productoUnidad">Unidad de Medida *</label>
          <select id="productoUnidad" required>
            <option value="">Seleccionar...</option>
            <option value="unidad">Unidad</option>
            <option value="litro">Litro</option>
            <option value="kg">Kilogramo</option>
            <option value="paquete">Paquete</option>
            <option value="caja">Caja</option>
          </select>
        </div>

        <div class="form-group">
          <label for="productoMarca">Marca</label>
          <select id="productoMarca">
            <option value="">Sin marca</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="productoProveedor">Proveedor</label>
          <select id="productoProveedor">
            <option value="">Sin proveedor</option>
          </select>
        </div>

        <div class="form-group">
          <label for="productoEstado">Estado</label>
          <select id="productoEstado">
            <option value="1">Activo</option>
            <option value="0">Inactivo</option>
          </select>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn--secondary" onclick="cerrarModalProducto()">Cancelar</button>
        <button type="submit" class="btn btn--primary">‚ûï Agregar Producto</button>
      </div>
    </form>
  </div>
</div>

<!-- ======================================================
     üîó M√ìDULOS DE CATEGOR√çAS
====================================================== -->
<script type="module" src="/src/js/dashboard/categorias.js"></script>
<!-- ‚ùå ELIMINAR: <script type="module" src="/src/js/dashboard/productos-vista.js"></script> -->
